[
  {
    "Id": "896600",
    "ThreadId": "390600",
    "Html": "\r\n<p>Hi, back again with an other question. The user can rate a movie and than the average needs to be recalculated. I can do this by simply reloading the page after the succes (I'm using sort of MVC) so when the view pops up it does this accordingly. But it\r\n isn't logical to reload a page with AJAX ;-). I'm pretty noobish in javascript (just know the basic formchecking and stuff).</p>\r\n<p>So I'm echoing the average in the action. and want to change the htmelement of the rating-value</p>\r\n<p>&nbsp;</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>        $.ajax({\r\n            url : <span style=\"color:#a31515\">'index.php?module=movies'</span>,\r\n            type : <span style=\"color:#a31515\">'POST'</span>,\r\n            data : data,\r\n            success : <span style=\"color:blue\">function</span>(data) {<span style=\"color:green\"></span>\r\n                $(<span style=\"color:#a31515\">&quot;#raaagh&quot;</span>).html(data);\r\n            },\r\n            error: <span style=\"color:blue\">function</span> () {\r\n                alert(<span style=\"color:#a31515\">'Error occured during rating!'</span>)\r\n            }\r\n        });<br><br>&nbsp;<div style=\"color:black; background-color:white\"><pre> <span style=\"color:green\">/**\r\n\t * Star rating action\r\n\t */</span>\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">function</span> doRating() {\r\n            <span style=\"color:blue\">if</span> (PlonkFilter::getPostValue(<span style=\"color:#a31515\">'formAction'</span>) === <span style=\"color:#a31515\">'rating'</span>) {\r\n                    $movieId = PlonkFilter::getPostValue(<span style=\"color:#a31515\">'movie_id'</span>);\r\n                    $rating = PlonkFilter::getPostValue(<span style=\"color:#a31515\">'rating'</span>);\r\n\r\n                    $username = PlonkSession::get(<span style=\"color:#a31515\">'username'</span>);\r\n                    $userId = MoviesDB::getUserIdByUsername($username);\r\n                                        \r\n                    <span style=\"color:green\">// create array to insert</span>\r\n                    $values = <span style=\"color:blue\">array</span>(\r\n                            <span style=\"color:#a31515\">'rating'</span> =&gt; $rating,\r\n                            <span style=\"color:#a31515\">'user_id'</span> =&gt; $userId,\r\n                            <span style=\"color:#a31515\">'movie_id'</span> =&gt; $movieId\r\n                    );\r\n                    \r\n                    \r\n                    <span style=\"color:green\">// store the rating</span>\r\n                    MoviesDB::insertRating($values);\r\n                    <br>                    // recalculate the rating\r\n                    $avgRating = MoviesDB::getAverageRatingByMovieId($movieId);\r\n                    \r\n                    <span style=\"color:blue\">echo</span> $avgRating;\r\n                    \r\n            }\r\n        }<br><br>This works in a test paragraph giving back the required average rating. :)<br><br>Now I want to change the value in the average div. <br></pre>\r\n</div>\r\n</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2012-08-07T09:32:20.243-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "901277",
    "ThreadId": "390600",
    "Html": "<p>It's pretty simple, the function that does the ajax, already gets the value from the rating plugin, which brings you already more than half way your solution</p>\r\n<p>&nbsp;</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>   <span style=\"color: blue;\">var</span> el = $(<span style=\"color: blue;\">this</span>);\r\n   <span style=\"color: green;\">// I guess this is your data obj.</span>\r\n   <span style=\"color: blue;\">var</span> data =  { rating:  el.rateit(<span style=\"color: #a31515;\">'value'</span>) };\r\n\r\n    $.ajax({\r\n            url : <span style=\"color: #a31515;\">'index.php?module=movies'</span>,\r\n            type : <span style=\"color: #a31515;\">'POST'</span>,\r\n            data : data,\r\n            success : <span style=\"color: blue;\">function</span>(data) {\r\n\r\n                 <span style=\"color: green;\">//if i want to change the rateit element that was changed:</span>\r\n                 el.rateit(<span style=\"color: #a31515;\">'value'</span>, data);\r\n\r\n                 <span style=\"color: green;\">//if i want to change some other rateit element:</span>\r\n                 $(<span style=\"color: #a31515;\">'#myotherrateit'</span>).rateit(<span style=\"color: #a31515;\">'value'</span>, data);\r\n\r\n\r\n\r\n            },\r\n            error: <span style=\"color: blue;\">function</span> () {\r\n                alert(<span style=\"color: #a31515;\">'Error occured during rating!'</span>)\r\n            }\r\n        });\r\n</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2012-08-19T06:08:08.067-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]